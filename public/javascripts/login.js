// Generated by CoffeeScript 1.3.3
(function() {

  $(document).ready(function() {
    $("#form-login").find("button").button();
    $("#form-register").find("button").button();
    $("#form-activate").find("button").button();
    $(".open-login").click(function() {
      var id;
      id = $(this).attr("now");
      $(id).hide();
      return $("#login").show();
    });
    $(".open-register").click(function() {
      var id;
      id = $(this).attr("now");
      $(id).hide();
      return $("#register").show();
    });
    $(".open-activate").click(function() {
      var id;
      id = $(this).attr("now");
      $(id).hide();
      return $("#activate").show();
    });
    $("#form-login").submit(function() {
      $(this).find('button').button('loading');
      $.ajax({
        data: $("#form-login").serialize(),
        url: $("#form-login").attr("action"),
        type: $("#form-login").attr("method"),
        statusCode: {
          200: function(data) {
            return $(location).attr("href", "/");
          },
          400: function(xhr) {
            var data, error, _i, _len, _ref;
            data = JSON.parse(xhr.responseText);
            $("#login").find(".code-400").show();
            _ref = data.errors;
            for (_i = 0, _len = _ref.length; _i < _len; _i++) {
              error = _ref[_i];
              $("#ctrl-login-" + error.param).addClass("warning");
            }
            return $("#form-login").find('button').button("reset");
          },
          404: function(xhr) {
            var data;
            data = JSON.parse(xhr.responseText);
            return $("#form-login").find('button').button("reset");
          },
          500: function(xhr) {
            return $("#form-login").find('button').button("reset");
          }
        }
      });
      return false;
    });
    $("#form-register").submit(function() {
      $("#form-register").find("button").button("loading");
      $.ajax({
        data: $("#form-register").serialize(),
        url: $("#form-register").attr("action"),
        type: $("#form-register").attr("method"),
        statusCode: {
          200: function(data) {
            $("#register").hide();
            $(".opens").hide();
            $("#activate").show();
            $("#activate").find(".code-200").show();
            return $("#form-register").find('button').button("reset");
          },
          400: function(xhr) {
            var data, error, _i, _len, _ref;
            data = JSON.parse(xhr.responseText);
            $("#register").find(".code-400").show();
            _ref = data.errors;
            for (_i = 0, _len = _ref.length; _i < _len; _i++) {
              error = _ref[_i];
              $("#ctrl-register-" + error.param).addClass("warning");
            }
            return $("#form-register").find('button').button("reset");
          },
          410: function(xhr) {
            var data;
            data = JSON.parse(xhr.responseText);
            return $("#form-register").find('button').button("reset");
          },
          500: function(xhr) {
            return $("#form-register").find('button').button("reset");
          }
        }
      });
      return false;
    });
    return $("#form-activate").submit(function() {
      $("#form-activate").find("button").button("loading");
      $.ajax({
        data: $("#form-activate").serialize(),
        url: $("#form-activate").attr("action"),
        type: $("#form-activate").attr("method"),
        statusCode: {
          200: function(data) {
            $("#activate").hide();
            $("#login").show();
            $("#login").find(".opens").hide();
            $("#login").find(".code-200").show();
            return $("#form-activate").find('button').button("reset");
          },
          400: function(xhr) {
            var data, error, _i, _len, _ref;
            data = JSON.parse(xhr.responseText);
            $("#activate").find(".code-400").show();
            $("#form-activate").each(function() {
              return this.reset();
            });
            _ref = data.errors;
            for (_i = 0, _len = _ref.length; _i < _len; _i++) {
              error = _ref[_i];
              $("#ctrl-activate-" + error.param).addClass("warning");
            }
            return $("#form-activate").find('button').button("reset");
          },
          404: function(xhr) {
            var data;
            data = JSON.parse(xhr.responseText);
            return $("#form-activate").find('button').button("reset");
          },
          500: function(xhr) {
            return $("#form-activate").find('button').button("reset");
          }
        }
      });
      return false;
    });
  });

}).call(this);
